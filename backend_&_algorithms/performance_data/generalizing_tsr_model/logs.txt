 -------------- TRAINING --------------
Tickers: ['MSFT', 'AAPL', 'NVDA', 'MRVL', 'GOOGL'], Start: 2022-01-01, End: 2023-01-01, Interval: 1d
[INFO] Downloading data for MSFT from 2022-01-01 to 2023-01-01 with interval 1d...
/home/sudonym/repos/ML-trading-bot/src/tsr_model/data_handler.py:28: FutureWarning: YF.download() has changed argument auto_adjust default to True
  df = yf.download(ticker, start=self.start, end=self.end, interval=self.interval)
[*********************100%***********************]  1 of 1 completed
[INFO] Data shape: (251, 5)
[INFO] Data shape after indicators: (238, 8)
Technical indicators plot saved to technical_indicators_MSFT_20250829_114152.png
[INFO] Creating sequences with sequence length 24...

(eog:15460): Gtk-WARNING **: 11:41:53.389: Theme parsing error: gtk.css:6754:15: Junk at end of value for padding
[INFO] X shape: (214, 24, 4), y shape: (214, 1)
[INFO] Downloading data for AAPL from 2022-01-01 to 2023-01-01 with interval 1d...
/home/sudonym/repos/ML-trading-bot/src/tsr_model/data_handler.py:28: FutureWarning: YF.download() has changed argument auto_adjust default to True
  df = yf.download(ticker, start=self.start, end=self.end, interval=self.interval)

(eog:15460): Gtk-WARNING **: 11:41:53.419: Theme parsing error: gtk.css:6754:15: Junk at end of value for padding

(eog:15460): Gtk-WARNING **: 11:41:53.440: Theme parsing error: gtk.css:6754:15: Junk at end of value for padding

(eog:15460): Gtk-WARNING **: 11:41:53.460: Theme parsing error: gtk-dark.css:6754:15: Junk at end of value for padding

(eog:15460): Gtk-WARNING **: 11:41:53.481: Theme parsing error: gtk-dark.css:6754:15: Junk at end of value for padding
[*********************100%***********************]  1 of 1 completed
[INFO] Data shape: (251, 5)
[INFO] Data shape after indicators: (238, 8)
Technical indicators plot saved to technical_indicators_AAPL_20250829_114153.png
[INFO] Creating sequences with sequence length 24...
[INFO] X shape: (214, 24, 4), y shape: (214, 1)
[INFO] Downloading data for NVDA from 2022-01-01 to 2023-01-01 with interval 1d...
/home/sudonym/repos/ML-trading-bot/src/tsr_model/data_handler.py:28: FutureWarning: YF.download() has changed argument auto_adjust default to True
  df = yf.download(ticker, start=self.start, end=self.end, interval=self.interval)
[*********************100%***********************]  1 of 1 completed
[INFO] Data shape: (251, 5)
[INFO] Data shape after indicators: (238, 8)
Technical indicators plot saved to technical_indicators_NVDA_20250829_114154.png
[INFO] Creating sequences with sequence length 24...
[INFO] X shape: (214, 24, 4), y shape: (214, 1)
[INFO] Downloading data for MRVL from 2022-01-01 to 2023-01-01 with interval 1d...
/home/sudonym/repos/ML-trading-bot/src/tsr_model/data_handler.py:28: FutureWarning: YF.download() has changed argument auto_adjust default to True
  df = yf.download(ticker, start=self.start, end=self.end, interval=self.interval)
[*********************100%***********************]  1 of 1 completed
[INFO] Data shape: (251, 5)
[INFO] Data shape after indicators: (238, 8)
Technical indicators plot saved to technical_indicators_MRVL_20250829_114156.png
[INFO] Creating sequences with sequence length 24...
[INFO] X shape: (214, 24, 4), y shape: (214, 1)
[INFO] Downloading data for GOOGL from 2022-01-01 to 2023-01-01 with interval 1d...
/home/sudonym/repos/ML-trading-bot/src/tsr_model/data_handler.py:28: FutureWarning: YF.download() has changed argument auto_adjust default to True
  df = yf.download(ticker, start=self.start, end=self.end, interval=self.interval)
[*********************100%***********************]  1 of 1 completed
[INFO] Data shape: (251, 5)
[INFO] Data shape after indicators: (238, 8)
Technical indicators plot saved to technical_indicators_GOOGL_20250829_114157.png
[INFO] Creating sequences with sequence length 24...
[INFO] X shape: (214, 24, 4), y shape: (214, 1)
[INFO] Combined dataset created with 1070 samples from 5 tickers.
[INFO] Starting training for 40 epochs, batch size 7, learning rate 0.0001
[INFO] Epoch 1/40, Average Loss: 0.4621
[INFO] Epoch 2/40, Average Loss: 0.1569
[INFO] Epoch 3/40, Average Loss: 0.1341
[INFO] Epoch 4/40, Average Loss: 0.1190
[INFO] Epoch 5/40, Average Loss: 0.0968
[INFO] Epoch 6/40, Average Loss: 0.0847
[INFO] Epoch 7/40, Average Loss: 0.0730
[INFO] Epoch 8/40, Average Loss: 0.0698
[INFO] Epoch 9/40, Average Loss: 0.0628
[INFO] Epoch 10/40, Average Loss: 0.0617
[INFO] Epoch 11/40, Average Loss: 0.0614
[INFO] Epoch 12/40, Average Loss: 0.0608
[INFO] Epoch 13/40, Average Loss: 0.0599
[INFO] Epoch 14/40, Average Loss: 0.0581
[INFO] Epoch 15/40, Average Loss: 0.0577
[INFO] Epoch 16/40, Average Loss: 0.0595
[INFO] Epoch 17/40, Average Loss: 0.0577
[INFO] Epoch 18/40, Average Loss: 0.0582
[INFO] Epoch 19/40, Average Loss: 0.0563
[INFO] Epoch 20/40, Average Loss: 0.0592
[INFO] Epoch 21/40, Average Loss: 0.0542
[INFO] Epoch 22/40, Average Loss: 0.0565
[INFO] Epoch 23/40, Average Loss: 0.0575
[INFO] Epoch 24/40, Average Loss: 0.0587
[INFO] Epoch 25/40, Average Loss: 0.0586
[INFO] Epoch 26/40, Average Loss: 0.0584
[INFO] Epoch 27/40, Average Loss: 0.0563
[INFO] Epoch 28/40, Average Loss: 0.0578
[INFO] Epoch 29/40, Average Loss: 0.0562
[INFO] Epoch 30/40, Average Loss: 0.0559
[INFO] Epoch 31/40, Average Loss: 0.0572
[INFO] Epoch 32/40, Average Loss: 0.0571
[INFO] Epoch 33/40, Average Loss: 0.0575
[INFO] Epoch 34/40, Average Loss: 0.0551
[INFO] Epoch 35/40, Average Loss: 0.0557
[INFO] Epoch 36/40, Average Loss: 0.0561
[INFO] Epoch 37/40, Average Loss: 0.0565
[INFO] Epoch 38/40, Average Loss: 0.0579
[INFO] Epoch 39/40, Average Loss: 0.0548
[INFO] Epoch 40/40, Average Loss: 0.0563
[INFO] Training complete.
Training loss plot saved to training_loss_20250829_114317.png
 -------------- TESTING --------------
Tickers: ['MSFT'], Start: 2022-01-01, End: 2023-01-01, Interval: 1d
[INFO] Downloading data for MSFT from 2022-01-01 to 2023-01-01 with interval 1d...
/home/sudonym/repos/ML-trading-bot/src/tsr_model/data_handler.py:28: FutureWarning: YF.download() has changed argument auto_adjust default to True
  df = yf.download(ticker, start=self.start, end=self.end, interval=self.interval)
[*********************100%***********************]  1 of 1 completed
[INFO] Data shape: (251, 5)

(eog:16130): Gtk-WARNING **: 11:43:17.445: Theme parsing error: gtk.css:6754:15: Junk at end of value for padding
[INFO] Data shape after indicators: (238, 8)

(eog:16130): Gtk-WARNING **: 11:43:17.474: Theme parsing error: gtk.css:6754:15: Junk at end of value for padding

(eog:16130): Gtk-WARNING **: 11:43:17.493: Theme parsing error: gtk.css:6754:15: Junk at end of value for padding

(eog:16130): Gtk-WARNING **: 11:43:17.512: Theme parsing error: gtk-dark.css:6754:15: Junk at end of value for padding

(eog:16130): Gtk-WARNING **: 11:43:17.531: Theme parsing error: gtk-dark.css:6754:15: Junk at end of value for padding
Technical indicators plot saved to technical_indicators_MSFT_20250829_114317.png
[INFO] Creating sequences with sequence length 24...
[INFO] X shape: (214, 24, 4), y shape: (214, 1)
[INFO] Combined dataset created with 214 samples from 1 tickers.
 Current price: $304.88, Predicted price: $284.09
 Current price: $299.49, Predicted price: $288.51
 Current price: $300.57, Predicted price: $290.43
 Current price: $305.96, Predicted price: $286.21
 Current price: $301.99, Predicted price: $291.57
 Current price: $290.93, Predicted price: $288.13
 Current price: $292.75, Predicted price: $281.88
 Current price: $288.48, Predicted price: $271.88
 Current price: $277.10, Predicted price: $269.32
 Current price: $273.99, Predicted price: $276.86

[TRADE] Bought stock at $273.99 per share, shares: 3.6497

 Current price: $279.39, Predicted price: $277.42

[TRADE] Sold stock for $279.39 per share, total: $1019.71, balance-change: $19.71

 Current price: $271.83, Predicted price: $272.01

[TRADE] Bought stock at $271.83 per share, shares: 3.7513

 Current price: $272.50, Predicted price: $268.73

[TRADE] Sold stock for $272.50 per share, total: $1022.23, balance-change: $2.51

 Current price: $277.14, Predicted price: $278.29

[TRADE] Bought stock at $277.14 per share, shares: 3.6885

 Current price: $278.17, Predicted price: $287.23
 Current price: $272.78, Predicted price: $288.97
 Current price: $266.19, Predicted price: $294.73
 Current price: $272.69, Predicted price: $293.52
 Current price: $262.49, Predicted price: $298.26
 Current price: $275.12, Predicted price: $293.31
 Current price: $281.35, Predicted price: $298.84
 Current price: $269.58, Predicted price: $298.35
 Current price: $276.33, Predicted price: $304.45
 Current price: $273.72, Predicted price: $307.68
 Current price: $281.69, Predicted price: $306.84
 Current price: $269.42, Predicted price: $301.97
 Current price: $266.87, Predicted price: $303.73
 Current price: $257.01, Predicted price: $307.30
 Current price: $261.79, Predicted price: $302.65
 Current price: $253.10, Predicted price: $292.47
 Current price: $248.05, Predicted price: $295.63
 Current price: $253.65, Predicted price: $290.93
 Current price: $254.02, Predicted price: $281.99
 Current price: $259.19, Predicted price: $279.43
 Current price: $247.39, Predicted price: $280.70
 Current price: $246.47, Predicted price: $276.72
 Current price: $245.91, Predicted price: $275.50
 Current price: $253.78, Predicted price: $277.39
 Current price: $252.78, Predicted price: $278.91
 Current price: $255.61, Predicted price: $275.75
 Current price: $258.90, Predicted price: $270.02
 Current price: $266.04, Predicted price: $272.69
 Current price: $264.71, Predicted price: $265.68
 Current price: $265.24, Predicted price: $273.26
 Current price: $267.35, Predicted price: $280.22
 Current price: $262.91, Predicted price: $269.64
 Current price: $261.67, Predicted price: $276.14
 Current price: $265.32, Predicted price: $273.62
 Current price: $263.29, Predicted price: $282.22
 Current price: $257.82, Predicted price: $268.19
 Current price: $246.33, Predicted price: $267.81
 Current price: $235.88, Predicted price: $257.91
 Current price: $238.05, Predicted price: $263.32
 Current price: $245.13, Predicted price: $254.87
 Current price: $238.52, Predicted price: $251.21
 Current price: $241.13, Predicted price: $254.99
 Current price: $247.06, Predicted price: $255.52
 Current price: $246.46, Predicted price: $260.61
 Current price: $252.04, Predicted price: $248.36

[TRADE] Sold stock for $252.04 per share, total: $929.65, balance-change: $-92.57

 Current price: $260.65, Predicted price: $249.35
 Current price: $257.91, Predicted price: $248.06
 Current price: $249.72, Predicted price: $255.16

[TRADE] Bought stock at $249.72 per share, shares: 3.7227

 Current price: $253.40, Predicted price: $253.98
 Current price: $250.07, Predicted price: $257.11
 Current price: $252.74, Predicted price: $260.21
 Current price: $255.93, Predicted price: $268.59
 Current price: $259.20, Predicted price: $265.89
 Current price: $261.33, Predicted price: $268.18
 Current price: $260.61, Predicted price: $270.64
 Current price: $257.54, Predicted price: $263.40
 Current price: $246.99, Predicted price: $263.63
 Current price: $246.06, Predicted price: $267.44
 Current price: $247.39, Predicted price: $265.32
 Current price: $249.96, Predicted price: $258.08
 Current price: $247.55, Predicted price: $246.50

[TRADE] Sold stock for $247.55 per share, total: $921.57, balance-change: $-8.08

 Current price: $252.69, Predicted price: $239.94
 Current price: $255.36, Predicted price: $240.54
 Current price: $257.86, Predicted price: $244.62
 Current price: $253.50, Predicted price: $240.72
 Current price: $252.01, Predicted price: $241.92
 Current price: $245.27, Predicted price: $246.54

[TRADE] Bought stock at $245.27 per share, shares: 3.7574

 Current price: $261.66, Predicted price: $246.94

[TRADE] Sold stock for $261.66 per share, total: $983.18, balance-change: $61.61

 Current price: $269.13, Predicted price: $251.59
 Current price: $273.35, Predicted price: $260.11
 Current price: $270.69, Predicted price: $258.78
 Current price: $267.58, Predicted price: $249.66
 Current price: $275.03, Predicted price: $254.04
 Current price: $276.18, Predicted price: $250.44
 Current price: $275.46, Predicted price: $253.15
 Current price: $272.94, Predicted price: $256.80
 Current price: $274.86, Predicted price: $260.22
 Current price: $281.54, Predicted price: $262.67
 Current price: $279.46, Predicted price: $262.71
 Current price: $284.22, Predicted price: $258.81
 Current price: $285.74, Predicted price: $246.51
 Current price: $285.00, Predicted price: $248.33
 Current price: $284.25, Predicted price: $248.37
 Current price: $283.13, Predicted price: $250.40
 Current price: $279.20, Predicted price: $248.57
 Current price: $271.01, Predicted price: $253.00
 Current price: $269.73, Predicted price: $255.34
 Current price: $269.10, Predicted price: $258.16
 Current price: $272.08, Predicted price: $254.07
 Current price: $261.58, Predicted price: $252.86
 Current price: $258.79, Predicted price: $247.18
 Current price: $256.59, Predicted price: $257.20

[TRADE] Bought stock at $256.59 per share, shares: 3.8318

 Current price: $255.12, Predicted price: $266.20
 Current price: $254.08, Predicted price: $272.74
 Current price: $249.84, Predicted price: $273.71
 Current price: $247.10, Predicted price: $271.03
 Current price: $251.83, Predicted price: $276.43
 Current price: $252.25, Predicted price: $277.33
 Current price: $258.04, Predicted price: $277.25
 Current price: $260.18, Predicted price: $274.61
 Current price: $245.87, Predicted price: $276.48
 Current price: $246.10, Predicted price: $281.98
 Current price: $239.42, Predicted price: $281.04
 Current price: $238.80, Predicted price: $286.02
 Current price: $238.58, Predicted price: $288.26
 Current price: $236.57, Predicted price: $286.54
 Current price: $233.15, Predicted price: $285.85
 Current price: $235.13, Predicted price: $284.56
 Current price: $232.15, Predicted price: $281.12
 Current price: $231.69, Predicted price: $273.37
 Current price: $230.67, Predicted price: $272.05
 Current price: $235.22, Predicted price: $271.11
 Current price: $231.74, Predicted price: $272.70
 Current price: $227.25, Predicted price: $266.04
 Current price: $234.90, Predicted price: $263.36
 Current price: $242.84, Predicted price: $261.03
 Current price: $243.15, Predicted price: $259.21
 Current price: $240.80, Predicted price: $257.69
 Current price: $228.55, Predicted price: $254.68
 Current price: $223.69, Predicted price: $251.62
 Current price: $219.94, Predicted price: $252.78
 Current price: $220.27, Predicted price: $253.08
 Current price: $228.55, Predicted price: $257.09
 Current price: $223.01, Predicted price: $259.62
 Current price: $231.76, Predicted price: $246.57
 Current price: $232.71, Predicted price: $246.53
 Current price: $230.74, Predicted price: $240.71
 Current price: $230.42, Predicted price: $239.88
 Current price: $236.24, Predicted price: $239.40
 Current price: $241.25, Predicted price: $237.58

[TRADE] Sold stock for $241.25 per share, total: $924.40, balance-change: $-58.77

 Current price: $244.58, Predicted price: $234.54
 Current price: $225.71, Predicted price: $236.21

[TRADE] Bought stock at $225.71 per share, shares: 4.0956

 Current price: $221.25, Predicted price: $233.46
 Current price: $230.14, Predicted price: $233.12
 Current price: $226.50, Predicted price: $232.07
 Current price: $222.63, Predicted price: $237.09
 Current price: $214.76, Predicted price: $232.84
 Current price: $209.05, Predicted price: $229.48
 Current price: $216.02, Predicted price: $237.44
 Current price: $222.34, Predicted price: $245.11
 Current price: $223.31, Predicted price: $245.08
 Current price: $219.06, Predicted price: $241.64
 Current price: $237.08, Predicted price: $226.44

[TRADE] Sold stock for $237.08 per share, total: $971.00, balance-change: $46.60

 Current price: $241.11, Predicted price: $225.31
 Current price: $235.69, Predicted price: $221.17
 Current price: $236.10, Predicted price: $221.35
 Current price: $236.53, Predicted price: $229.12
 Current price: $236.48, Predicted price: $223.30
 Current price: $236.03, Predicted price: $232.91
 Current price: $236.84, Predicted price: $234.02
 Current price: $239.76, Predicted price: $231.61
 Current price: $242.25, Predicted price: $231.76
 Current price: $242.16, Predicted price: $237.88
 Current price: $236.56, Predicted price: $242.50

[TRADE] Bought stock at $236.56 per share, shares: 4.1047

 Current price: $235.16, Predicted price: $246.01
 Current price: $249.65, Predicted price: $224.05

[TRADE] Sold stock for $249.65 per share, total: $1024.74, balance-change: $53.74

 Current price: $249.21, Predicted price: $224.23
 Current price: $249.53, Predicted price: $230.53
 Current price: $244.82, Predicted price: $226.56
 Current price: $239.84, Predicted price: $222.56
 Current price: $239.11, Predicted price: $215.49
 Current price: $242.08, Predicted price: $211.56
 Current price: $240.14, Predicted price: $215.64
 Current price: $247.08, Predicted price: $221.45
 Current price: $251.39, Predicted price: $223.59
 Current price: $251.68, Predicted price: $219.13
 Current price: $243.65, Predicted price: $235.56
 Current price: $239.42, Predicted price: $242.33

[TRADE] Bought stock at $239.42 per share, shares: 4.2800

 Current price: $235.27, Predicted price: $236.81
 Current price: $236.60, Predicted price: $239.85
 Current price: $239.17, Predicted price: $239.55
 Current price: $233.06, Predicted price: $237.83
 Current price: $233.59, Predicted price: $238.27
 Current price: $231.86, Predicted price: $239.30
 Current price: $229.48, Predicted price: $242.86
 Current price: $235.82, Predicted price: $244.90
 Current price: $234.66, Predicted price: $243.60
[INFO] Final portfolio value: $1004.34